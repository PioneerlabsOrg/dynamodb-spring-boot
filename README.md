# dynamodb-spring-boot

[![Coverage Status](https://coveralls.io/repos/github/wonwoo/dynamodb-spring-boot/badge.svg?branch=master)](https://coveralls.io/github/wonwoo/dynamodb-spring-boot?branch=master) [![Build Status](https://travis-ci.org/wonwoo/dynamodb-spring-boot.svg?branch=master)](https://travis-ci.org/wonwoo/dynamodb-spring-boot) [![Build Status](https://semaphoreci.com/api/v1/wonwoo/dynamodb-spring-boot/branches/master/badge.svg)](https://semaphoreci.com/wonwoo/dynamodb-spring-boot) [ ![Download](https://api.bintray.com/packages/wonwoo/dynamodb-spring-boot/dynamodb-spring-boot/images/download.svg) ](https://bintray.com/wonwoo/dynamodb-spring-boot/dynamodb-spring-boot/_latestVersion) [![Maven Central](https://maven-badges.herokuapp.com/maven-central/com.github.wonwoo/dynamodb-spring-boot/badge.svg)](https://maven-badges.herokuapp.com/maven-central/com.github.wonwoo/dynamodb-spring-boot) 


### spring boot version

| dynamodb-spring-boot-starter version  | spring-data-dynamodb version            | Spring Boot version            |
| ------------------------------------- | --------------------------------------- |--------------------------------|
| 0.1.2                                 | 4.5.x                                   |  >= 1.4.0 < 2.0                |
| 1.0.x                                 | 5.0.x                                   |  >= 2.0                        |


### dynamodb-spring-boot Example

1. application.properties
```
spring.data.dynamodb.access-key=<your access-key>
spring.data.dynamodb.secret-key=<your secret-key>
```

2. PersonRepository 
```java
@EnableScan
public interface PersonRepository extends DynamoDBRepository<Person, String> {
}
```

3. Person

```java
@DynamoDBTable(tableName = "persons")
public class Person {

    @DynamoDBHashKey
    @DynamoDBAutoGeneratedKey
    private String id;
    private String name;

    public Person() {

    }
    // getter setter etc
}
```

4.  Sample
```java
@Bean
CommandLineRunner commandLineRunner(PersonRepository personRepository) {
    return args -> {
        personRepository.save(Arrays.asList(
                new Person("kevin"),
                new Person("josh long"))
        );
        personRepository.findAll()
                .forEach(System.out::println);
    };
}
```

#### Maven Install 

```xml
<dependency>
    <groupId>com.github.wonwoo</groupId>
    <artifactId>dynamodb-spring-boot-starter</artifactId>
    <version>{version}-RELEASE</version>
</dependency>
```

#### Create DDL
```
spring.data.dynamodb.ddl.enabled=true
```

`spring.data.dynamodb.ddl.enabled` default by `false`

### dynamodb-spring-boot-test Example

#### @DynamoTest 

```java
@DynamoTest
@RunWith(SpringRunner.class)
public class PersonRepositoryTests {

    @Autowired
    private PersonRepository personRepository;

    @Test
    public void save() {
        List<Person> persons = personRepository.findAll();
        assertThat(persons).hasSize(2);
    }
}

```

#### Maven Install 

```xml
<dependency>
  <groupId>com.github.wonwoo</groupId>
  <artifactId>dynamodb-spring-boot-starter-test</artifactId>
  <version>{version}-RELEASE</version>
  <scope>test</scope>
</dependency>
```


#### Embedded Dynamodb setting

1. maven dependency
```xml
<dependency>
  <groupId>com.amazonaws</groupId>
  <artifactId>DynamoDBLocal</artifactId>
  <version>{local.version}</version>  
  <scope>test</scope>
</dependency>

<dependency>
  <groupId>com.almworks.sqlite4java</groupId>
  <artifactId>sqlite4java</artifactId>
  <version>{local.version}</version>  
  <scope>test</scope>
</dependency>

```

2. maven plugins

```xml
<plugins>
  <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-dependency-plugin</artifactId>
    <executions>
      <execution>
        <id>copy-dependencies</id>
        <phase>process-test-resources</phase>
        <goals>
          <goal>copy-dependencies</goal>
        </goals>
        <configuration>
          <outputDirectory>${project.build.directory}/dependencies</outputDirectory>
          <overWriteReleases>false</overWriteReleases>
          <overWriteSnapshots>false</overWriteSnapshots>
          <overWriteIfNewer>true</overWriteIfNewer>
        </configuration>
      </execution>
    </executions>
  </plugin>
  <plugin>
    <artifactId>maven-surefire-plugin</artifactId>
    <version>${maven-surefire-plugin.version}</version>
    <configuration>
      <argLine>-Dsqlite4java.library.path=${basedir}/target/dependencies</argLine>
    </configuration>
  </plugin>
</plugins>
```

### Sample code github

[Sample](https://github.com/wonwoo/dynamodb-spring-boot/tree/master/dynamodb-spring-boot-sample)

[SampleApplication](https://github.com/wonwoo/dynamodb-spring-boot/blob/master/dynamodb-spring-boot-sample/src/main/java/com/github/wonwoo/dynamodb/SampleApplication.java)

[PersonRepositoryTests](https://github.com/wonwoo/dynamodb-spring-boot/blob/master/dynamodb-spring-boot-sample/src/test/java/com/github/wonwoo/dynamodb/PersonRepositoryTests.java)

# Read more here 
- [spring-data-dynamodb](https://github.com/spring-data-dynamodb/spring-data-dynamodb)
- [spring-data-dynamodb-wiki](https://github.com/spring-data-dynamodb/spring-data-dynamodb/wiki)


 


